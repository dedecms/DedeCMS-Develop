<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>修改自定义表单</title>
<meta name="copyright" content="2007-2020 DedeCMS, 上海卓卓网络科技有限公司 (DesDev, Inc.)" />
<link rel="icon" href="/favicon.ico" />
<!-- CSS FILES -->
<link rel="stylesheet" type="text/css" href="{dede:global.cfg_assets_dir/}/pkg/uikit/css/uikit.min.css" />
<link rel="stylesheet" type="text/css" href="{dede:global.cfg_assets_dir/}/css/manage.dede.css">
<style type="text/css">
.uk-table td{
padding: 6px 12px;
vertical-align: top;
height: 35px;
}
</style>
</head>
<body>
<!-- 列表头部 -->
<div id="Table_Header_202X2W2X1X292F" class="uk-card uk-card-small uk-card-default" uk-sticky="bottom: #offset">
<div id="Header_1W2T2S2T1V252B" class="uk-card-header">
<div class="uk-grid uk-grid-small uk-text-small">
<span><ul class="uk-breadcrumb"><li>修改自定义表单</li></ul></span>
</div>
</div>
</div>
<!-- /列表头部 -->
<!-- 列表主体 -->
<div class="uk-card uk-card-small uk-card-default" style="top:-20px;margin-bottom: 50px;">
<div class="uk-card-body uk-overflow-auto" grid>
<div class="uk-child-width-1-1 uk-padding">
<table width="98%" border="0" cellpadding="1" cellspacing="1" class="uk-table">
<form name="form1" action="diy_edit.php" method="post" onsubmit="return checkSubmit();"></form>
<input type="hidden" name="diyid" value="<?php echo $diyid;?>"/>
<input type="hidden" name="dopost" value="save"/>
<tr>
<td width="170">自定义表单 DiyID：<br/>
</td>
<td>
<?php echo $diyid;?> (数字，创建后不可更改，并具有唯一性。)
</td>
</tr>
<tr>
<td>自定义表单名称：<br/>
<span class="STYLE2" id="help3">　　</span>
</td>
<td>
<input name="name" type="text" id="name" value="<?php echo $row['name']?>" class="uk-input uk-form-small  uk-form-width-large"/> 自定义表单的中文名称，在后台管理，前台发布等均使用此名字。
</td>
</tr>
<tr>
<td>数据表：<br/>
</td>
<td>
<input name="table" type="text" id="table" disabled="1" value="<?php echo $row['table']; ?>" class="uk-input uk-form-small  uk-form-width-large"/> 自定义表单数据表创建后不可修改表名
</td>
</tr>
<tr>
<td>模型字段配置：<br/>
信息索引类字段系统已经加入，<br/>
您只需要增加其它个性化字段即可。</td>
<td>
<a href="diy_field_add.php?diyid=<?php echo $diyid;?>">添加新字段</a>
</td>
</tr>
<tr>
<td colspan="2">
<table width="100%" border="0" cellpadding="1" cellspacing="1" class="uk-table">
<thead>
<td width="28%">表单提示文字</td>
<td width="18%">数据字段名</td>
<td width="20%">数据类型</td>
<td width="18%">表单类型</td>
<td>维护</td>
</thead>
<tbody>

<?php  $ds = file(DedeInclude('/inc/fieldtype.txt'));
foreach($ds as $d){
$dds = explode(',',trim($d));
$fieldtypes[$dds[0]] = $dds[1];
}


$fieldset = $row['info'];
$dtp = new DedeTagParse();
$dtp->SetNameSpace("field","<",">");
$dtp->LoadSource($fieldset);
if(is_array($dtp->CTags)){
foreach($dtp->CTags as $ctag)
{
?>  <tr>
<td>
<?php 
$itname = $ctag->GetAtt('itemname');
if($itname=='') {echo "没指定";}
else { echo $itname;}
?>
</td>
<td>
<?php echo $ctag->GetTagName()?>
</td>
<td>
<?php 
$ft = $ctag->GetAtt('type');
if(isset($fieldtypes[$ft])) {echo $fieldtypes[$ft];}
else  {echo "系统专用类型";}
?>
</td>
<td>
<?php 
$ft = $ctag->GetAtt('autofield');
if($ft==''||$ft==0) {echo "固化表单";}
else  {echo "自动表单";}
?>
</td>
<td>
<a href="diy_field_edit.php?diyid=<?php echo $diyid;?>&fname=<?php echo $ctag->GetTagName()?>">[修改]</a>
<a href="diy_field_edit.php?diyid=<?php echo $diyid;?>&action=delete&fname=<?php echo $ctag->GetTagName()?>">[删除]</a>
</td>
</tr>
<?php 
}}

?>
</tbody>
</table>
</td>
</tr>
<tr>
<td>列表模板：</td>
<td>
<input name="listtemplate" type="text" id="listtemplate" value="<?php echo $row['listtemplate'];?>" class="uk-input uk-form-small  uk-form-width-large"/>
</td>
</tr>
<tr>
<td>内容模板：</td>
<td>
<input name="viewtemplate" type="text" id="viewtemplate" value="<?php echo $row['viewtemplate'];?>" class="uk-input uk-form-small  uk-form-width-large"/>
</td>
</tr>
<tr>
<td>发布模板：</td>
<td>
<input name="posttemplate" type="text" id="posttemplate" value="<?php echo $row['posttemplate'];?>" class="uk-input uk-form-small  uk-form-width-large"/>
</td>
</tr>
<tr>
<td>前台列表和内容页公开？：</td>
<td>
<label><input name="public" type="radio" value="2" <?php echo $row['public'] == 2 ? 'checked' : '';?> class="uk-radio"/> 完全公开</label> &nbsp;&nbsp;
<label><input name="public" type="radio" value="1" <?php echo $row['public'] == 1 ? 'checked' : '';?> class="uk-radio"/> 公开审核过的</label> &nbsp;&nbsp;
<label><input name="public" type="radio" value="0" <?php echo $row['public'] == 0 ? 'checked' : '';?> class="uk-radio"/> 不公开</label>
</td>
</tr>
</table>
</div>
</div>
<div class="uk-card-footer " >
<div class="uk-padding-small" >
<button type="submit" class="uk-button uk-button-small uk-button-primary">提交</button>
</div>
</div>
</div>
</form>
<!-- 列表底部 -->
<div class="bar-bottom uk-flex uk-light uk-flex-right">
<div class="uk-button-group" style="margin-left: 50px;">
</div>
<div class="e1e02">Copyright &copy; 2007-2020 <a href='http://www.dedecms.com' target='_blank'><u>DedeCMS</u></a>, 上海卓卓网络科技有限公司 (DesDev, Inc.)</div>
</div>
<!-- 列表底部 -->
<!-- JS FILES -->
<script src="{dede:global.cfg_assets_dir/}/pkg/uikit/js/uikit.min.js"></script>
<script src="{dede:global.cfg_assets_dir/}/pkg/uikit/js/uikit-icons.min.js"></script>
<script src="{dede:global.cfg_assets_dir/}/pkg/jquery/jquery.min.js"></script>
<script src="{dede:global.cfg_assets_dir/}/js/dede.manage.min.js"></script>
<script language="javascript">
function checkSubmit() {
if (document.form1.name.value == '') {
alert("自定义表单名称不能为空！");
return false;
}
return true;
}
</script>
<!-- / JS FILES -->
</body>
</html>

